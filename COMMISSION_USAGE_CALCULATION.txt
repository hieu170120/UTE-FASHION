================================================================================
H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG CHI·∫æT KH·∫§U V√Ä C√ÅCH T√çNH TO√ÅN KHI C√ì ƒê∆†N H√ÄNG TH√ÄNH C√îNG
================================================================================

NG√ÄY: 24/10/2025
PHI√äN B·∫¢N: 1.0
CH·ª¶ ƒê·ªÄ: Commission Management - Quy Tr√¨nh T√≠nh To√°n Chi·∫øt Kh·∫•u

================================================================================
I. KH√ÅI NI·ªÜM CHI·∫æT KH·∫§U (COMMISSION)
================================================================================

1. ƒê·ªãnh Nghƒ©a:
   - Chi·∫øt kh·∫•u l√† ph√≠ hoa h·ªìng m√† n·ªÅn t·∫£ng (Platform) l·∫•y t·ª´ m·ªói ƒë∆°n h√†ng
   - ƒê∆∞·ª£c t√≠nh t·ª´ t·ªïng ti·ªÅn order (totalAmount)
   - T√≠nh b·∫±ng ph·∫ßn trƒÉm (%) ƒë∆∞·ª£c c·∫•u h√¨nh cho m·ªói shop
   - L√† doanh thu c·ªßa platform, kh√¥ng ph·∫£i c·ªßa shop

2. M·ª•c ƒê√≠ch:
   - Thu nh·∫≠p cho n·ªÅn t·∫£ng t·ª´ ho·∫°t ƒë·ªông kinh doanh c·ªßa shop
   - Gi√∫p platform t·ª± ƒëi v√†o
   - L√† kho·∫£n ph√≠ d·ªãch v·ª• m√† shop ph·∫£i tr·∫£ ƒë·ªÉ b√°n h√†ng tr√™n platform

3. M√¥ H√¨nh Kinh T·∫ø:
   
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ KH√ÅCH H√ÄNG      ‚îÇ
   ‚îÇ  thanh to√°n     ‚îÇ
   ‚îÇ 100.000 ƒë       ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚Üì
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ PLATFORM nh·∫≠n to√†n b·ªô 100.000 ƒë     ‚îÇ
   ‚îÇ (qua Payment Gateway)               ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚îú‚îÄ‚Üí Chi·∫øt kh·∫•u (10%) = 10.000 ƒë    [PLATFORM GI·ªÆ]
            ‚îÇ
            ‚îú‚îÄ‚Üí Ti·ªÅn cho shop = 90.000 ƒë       [SHOP NH·∫¨N]
            ‚îÇ
            ‚îî‚îÄ‚Üí Ghi nh·∫≠n doanh thu shop = 100.000 ƒë [REPORT/ANALYTICS]

================================================================================
II. C√ÅCH T√çNH TO√ÅN CHI TI·∫æT
================================================================================

C√îNG TH·ª®C C∆† B·∫¢N:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Chi·∫øt Kh·∫•u (Ti·ªÅn) = T·ªïng Ti·ªÅn √ó Chi·∫øt Kh·∫•u (%)       ‚îÇ
‚îÇ                  = totalAmount √ó commissionPercentage  ‚îÇ
‚îÇ                      / 100                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Ti·ªÅn Shop Nh·∫≠n = T·ªïng Ti·ªÅn - Chi·∫øt Kh·∫•u (Ti·ªÅn)       ‚îÇ
‚îÇ               = totalAmount - commissionAmount        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Doanh Thu Ghi Nh·∫≠n = T·ªïng Ti·ªÅn                        ‚îÇ
‚îÇ                   = totalAmount                       ‚îÇ
‚îÇ (Hi·ªÉn th·ªã cho shop xem doanh thu, nh∆∞ng b·ªã tr·ª´        ‚îÇ
‚îÇ  chi·∫øt kh·∫•u khi t√≠nh ti·ªÅn th·ª±c nh·∫≠n)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

V√ç D·ª§ T√çNH TO√ÅN:

‚îå‚îÄ T·ªïng Ti·ªÅn (totalAmount):        100.000 ƒë
‚îú‚îÄ Chi·∫øt Kh·∫•u (%):                 10%
‚îú‚îÄ Chi·∫øt Kh·∫•u (Ti·ªÅn):              100.000 √ó 10% = 10.000 ƒë
‚îú‚îÄ Ti·ªÅn Shop Nh·∫≠n:                 100.000 - 10.000 = 90.000 ƒë
‚îú‚îÄ Doanh Thu Ghi Nh·∫≠n:             100.000 ƒë (c√¥ng khai)
‚îî‚îÄ Doanh Thu Th·ª±c T·∫ø:              90.000 ƒë (sau tr·ª´ chi·∫øt kh·∫•u)

================================================================================
III. QUY TR√åNH X·ª¨ L√ù KHI C√ì ƒê∆†N H√ÄNG TH√ÄNH C√îNG
================================================================================

B∆Ø·ªöC 1: KH√ÅCH H√ÄNG ƒê·∫∂T H√ÄNG
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Th·ªùi gian: T = 10:30 AM

Kh√°ch h√†ng ch·ªçn s·∫£n ph·∫©m t·ª´ Shop A:
  ‚îú‚îÄ √Åo ph√¥ng (T√™n shop: "Fashion Store A")
  ‚îÇ  ‚îú‚îÄ Gi√°: 50.000 ƒë
  ‚îÇ  ‚îú‚îÄ S·ªë l∆∞·ª£ng: 1
  ‚îÇ  ‚îî‚îÄ Th√†nh ti·ªÅn: 50.000 ƒë
  ‚îÇ
  ‚îú‚îÄ Qu·∫ßn jeans
  ‚îÇ  ‚îú‚îÄ Gi√°: 300.000 ƒë
  ‚îÇ  ‚îú‚îÄ S·ªë l∆∞·ª£ng: 1
  ‚îÇ  ‚îî‚îÄ Th√†nh ti·ªÅn: 300.000 ƒë
  ‚îÇ
  ‚îî‚îÄ Chi ph√≠ kh√°c:
     ‚îú‚îÄ Ph√≠ v·∫≠n chuy·ªÉn: 50.000 ƒë
     ‚îú‚îÄ Thu·∫ø (n·∫øu c√≥): 0 ƒë
     ‚îî‚îÄ Gi·∫£m gi√° (coupon): 0 ƒë

T√çNH TO√ÅN SUBTOTAL V√Ä TOTALAMOUNT:
  
  Subtotal = 50.000 + 300.000 = 350.000 ƒë
  Shipping Fee = 50.000 ƒë
  Discount = 0 ƒë
  Tax = 0 ƒë
  
  TotalAmount = Subtotal + ShippingFee - Discount + Tax
              = 350.000 + 50.000 - 0 + 0
              = 400.000 ƒë
              
Kh√°ch thanh to√°n: 400.000 ƒë ‚úì

‚ùå CHI·∫æT KH·∫§U CH∆ØA T√çNH L√öC N√ÄY
(Ch·ªâ t√≠nh khi order Delivered)


B∆Ø·ªöC 2: ORDER ƒê∆Ø·ª¢C T·∫†O TRONG H·ªÜ TH·ªêNG
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

D·ªØ li·ªáu Order:
  ‚îú‚îÄ OrderID: 12345
  ‚îú‚îÄ OrderNumber: "ORD-2025-001234"
  ‚îú‚îÄ ShopID: 1
  ‚îú‚îÄ Shop: "Fashion Store A"
  ‚îú‚îÄ Customer: Kh√°ch h√†ng A
  ‚îú‚îÄ OrderDate: 2025-10-24 10:30:00
  ‚îú‚îÄ OrderStatus: "Processing" (ƒêang x·ª≠ l√Ω)
  ‚îú‚îÄ PaymentStatus: "Paid" (ƒê√£ thanh to√°n)
  ‚îú‚îÄ Subtotal: 350.000 ƒë
  ‚îú‚îÄ ShippingFee: 50.000 ƒë
  ‚îú‚îÄ DiscountAmount: 0 ƒë
  ‚îú‚îÄ TaxAmount: 0 ƒë
  ‚îî‚îÄ TotalAmount: 400.000 ƒë

Ki·ªÉm tra Shop A c√≥ chi·∫øt kh·∫•u kh√¥ng:
  ‚îú‚îÄ Shop Commission_Percentage: 10%
  ‚îî‚îÄ ‚úì C√≥ c·∫•u h√¨nh chi·∫øt kh·∫•u 10%


B∆Ø·ªöC 3: ORDER ƒêANG GIAO H√ÄNG
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

OrderStatus: "Shipping" (ƒêang giao)
Shipper x√°c nh·∫≠n nh·∫≠n ƒë∆°n, giao cho kh√°ch h√†ng...


B∆Ø·ªöC 4: KH√ÅCH NH·∫¨N H√ÄNG TH√ÄNH C√îNG ‚úì (ƒê√ÇY L√Ä ƒêI·ªÇM QUAN TR·ªåNG!)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Th·ªùi gian: T = 14:00 (c√πng ng√†y)

OrderStatus: "Delivered" (Ho√†n th√†nh)
DeliveredAt: 2025-10-24 14:00:00

üîî T·∫†I TH·ªúI ƒêI·ªÇM N√ÄY:
   DailyAnalyticsService.updateDailyAnalytics() ƒë∆∞·ª£c g·ªçi
   
   H·ªá th·ªëng b·∫Øt ƒë·∫ßu t√≠nh to√°n CHI·∫æT KH·∫§U


B∆Ø·ªöC 5: H·ªÜ TH·ªêNG T√çNH TO√ÅN CHI·∫æT KH·∫§U
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Code trong ShopServiceImpl.updateShopCommission() ho·∫∑c 
DailyAnalyticsServiceImpl.updateShopAnalytics():

```java
// L·∫•y th√¥ng tin order
Order order = orderRepository.findById(12345);
// Order.TotalAmount = 400.000 ƒë

// L·∫•y shop
Shop shop = order.getShop();
// Shop.CommissionPercentage = 10.00 (%)

// T√çNH TO√ÅN CHI·∫æT KH·∫§U
BigDecimal totalAmount = order.getTotalAmount();  // 400.000
BigDecimal commissionPercentage = shop.getCommissionPercentage();  // 10.00
BigDecimal commissionAmount = totalAmount
    .multiply(commissionPercentage)
    .divide(new BigDecimal("100"), 2, RoundingMode.HALF_UP);

// commissionAmount = 400.000 √ó 10 / 100 = 40.000 ƒë

// Ti·ªÅn shop th·ª±c nh·∫≠n
BigDecimal shopNetRevenue = totalAmount.subtract(commissionAmount);
// shopNetRevenue = 400.000 - 40.000 = 360.000 ƒë
```

K·∫æT QU·∫¢ T√çNH TO√ÅN:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ PH√ÇN CHIA TI·ªÄN HO CHI TI·∫æT            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ T·ªïng Ti·ªÅn Kh√°ch Thanh To√°n:  400.000 ƒë ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ PH√çA PLATFORM:                        ‚îÇ
‚îÇ ‚îú‚îÄ Chi·∫øt Kh·∫•u (10%):       40.000 ƒë  ‚îÇ
‚îÇ ‚îî‚îÄ Subtotal Platform:      40.000 ƒë  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ PH√çA SHOP A:                          ‚îÇ
‚îÇ ‚îú‚îÄ Ti·ªÅn B√°n H√†ng:          350.000 ƒë ‚îÇ
‚îÇ ‚îú‚îÄ Tr·ª´ Chi·∫øt Kh·∫•u:        -40.000 ƒë ‚îÇ
‚îÇ ‚îú‚îÄ C·ªông Ph√≠ V·∫≠n Chuy·ªÉn:     50.000 ƒë ‚îÇ
‚îÇ ‚îî‚îÄ T·ªïng Shop Nh·∫≠n:         360.000 ƒë ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ KI·ªÇM CH·ª®NG:                           ‚îÇ
‚îÇ Platform + Shop = 40.000 + 360.000   ‚îÇ
‚îÇ                = 400.000 ƒë ‚úì         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


B∆Ø·ªöC 6: C·∫¨P NH·∫¨T D·ªÆ LI·ªÜU ANALYTICS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

ShopAnalytics record ƒë∆∞·ª£c t·∫°o/c·∫≠p nh·∫≠t:

```
ShopAnalytics (New or Updated):
‚îú‚îÄ AnalyticsID: 56789
‚îú‚îÄ ShopID: 1
‚îú‚îÄ PeriodType: "DAY"
‚îú‚îÄ PeriodStart: 2025-10-24
‚îú‚îÄ PeriodEnd: 2025-10-24
‚îú‚îÄ TotalRevenue: 400.000 ƒë  ‚Üê Doanh thu ghi nh·∫≠n
‚îú‚îÄ TotalOrders: 1
‚îú‚îÄ CommissionPercentage: 10.00%  ‚Üê T·ª∑ l·ªá chi·∫øt kh·∫•u
‚îú‚îÄ CommissionAmount: 40.000 ƒë   ‚Üê Ti·ªÅn chi·∫øt kh·∫•u
‚îú‚îÄ ShopNetRevenue: 360.000 ƒë    ‚Üê Ti·ªÅn shop th·ª±c nh·∫≠n
‚îî‚îÄ GrowthPercent: 0% (ƒë∆°n ƒë·∫ßu ti√™n)
```

HO·∫∂C n·∫øu ƒë√£ c√≥ record ng√†y h√¥m nay:

```
ShopAnalytics (Updated):
‚îú‚îÄ TotalRevenue: 800.000 ƒë  (c·ªông th√™m 400.000 t·ª´ order n√†y)
‚îú‚îÄ TotalOrders: 2
‚îú‚îÄ CommissionAmount: 80.000 ƒë  (c·ªông th√™m 40.000)
‚îú‚îÄ ShopNetRevenue: 720.000 ƒë   (c·ªông th√™m 360.000)
‚îî‚îÄ [c√°c field kh√°c c·∫≠p nh·∫≠t]
```


B∆Ø·ªöC 7: HI·ªÇN TH·ªä TR√äN DASHBOARD
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

ADMIN XEM (Admin Dashboard):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ COMMISSION MANAGEMENT           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Shop ID: 1                      ‚îÇ
‚îÇ Shop Name: Fashion Store A      ‚îÇ
‚îÇ Commission %: 10%               ‚îÇ
‚îÇ Thay ƒë·ªïi chi·∫øt kh·∫•u    [S·ª¨A]    ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ H√¥m nay (2025-10-24):          ‚îÇ
‚îÇ ‚îú‚îÄ Doanh thu ghi nh·∫≠n: 400.000 ‚îÇ
‚îÇ ‚îú‚îÄ Chi·∫øt kh·∫•u: 40.000          ‚îÇ
‚îÇ ‚îî‚îÄ Ti·ªÅn shop nh·∫≠n: 360.000     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

SHOP OWNER XEM (Shop Dashboard):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DASHBOARD SHOP A                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ H√¥m nay:                        ‚îÇ
‚îÇ T·ªïng Doanh Thu: 400.000 ƒë      ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ Chi Ti·∫øt:                       ‚îÇ
‚îÇ ‚îú‚îÄ B√°n h√†ng: 350.000 ƒë        ‚îÇ
‚îÇ ‚îú‚îÄ Ph√≠ v·∫≠n chuy·ªÉn: 50.000 ƒë  ‚îÇ
‚îÇ ‚îú‚îÄ Chi·∫øt kh·∫•u: -40.000 ƒë     ‚îÇ
‚îÇ ‚îî‚îÄ T·ªïng nh·∫≠n: 360.000 ƒë      ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ Ti·ªÅn c√≥ th·ªÉ r√∫t: 360.000 ƒë    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


B∆Ø·ªöC 8: T√çNH TO√ÅN TI·ªÄN R√öT CHO SHOP
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

N·∫øu shop mu·ªën r√∫t ti·ªÅn:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ T√çNH TI·ªÄN C√ì TH·ªÇ R√öT          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ShopNetRevenue (h√¥m nay): 360.000 ƒë
‚îÇ ƒê√£ r√∫t tr∆∞·ªõc:             0 ƒë
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ C√ì TH·ªÇ R√öT:              360.000 ƒë
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

C√¥ng th·ª©c:
  Ti·ªÅn C√≥ Th·ªÉ R√∫t = ShopNetRevenue - (ƒê√£ R√∫t)
                  = 360.000 - 0
                  = 360.000 ƒë

================================================================================
IV. B·∫¢NG T√ì·≤õ T·∫ÆT - TO√ÄN B·ªò QUYTR√åNH
================================================================================

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ B∆∞·ªõc     ‚îÇ Th·ªùi Gian‚îÇ Status   ‚îÇ Total    ‚îÇ Chi·∫øt KH ‚îÇ Ti·ªÅn Shop‚îÇ Net Rev  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1. ƒê·∫∑t   ‚îÇ 10:30    ‚îÇ Processing‚îÇ 400.000‚îÇ ‚ùå Ch∆∞a ‚îÇ -        ‚îÇ -        ‚îÇ
‚îÇ 2. T·∫°o   ‚îÇ 10:30    ‚îÇ Processing‚îÇ 400.000‚îÇ ‚ùå Ch∆∞a ‚îÇ -        ‚îÇ -        ‚îÇ
‚îÇ 3. Giao  ‚îÇ 10:45    ‚îÇ Shipping ‚îÇ 400.000‚îÇ ‚ùå Ch∆∞a ‚îÇ -        ‚îÇ -        ‚îÇ
‚îÇ 4. Nh·∫≠n  ‚îÇ 14:00    ‚îÇ Delivered‚îÇ 400.000‚îÇ ‚úÖ 40.000‚îÇ -        ‚îÇ -        ‚îÇ
‚îÇ 5. T√≠nh  ‚îÇ 14:00    ‚îÇ Delivered‚îÇ 400.000‚îÇ ‚úÖ 40.000‚îÇ -        ‚îÇ -        ‚îÇ
‚îÇ 6. C·∫≠p   ‚îÇ 14:00    ‚îÇ Delivered‚îÇ 400.000‚îÇ ‚úÖ 40.000‚îÇ 400.000 ‚îÇ 360.000  ‚îÇ
‚îÇ 7. B√°o   ‚îÇ 14:00+   ‚îÇ Delivered‚îÇ 400.000‚îÇ ‚úÖ 40.000‚îÇ 400.000 ‚îÇ 360.000  ‚îÇ
‚îÇ 8. R√∫t   ‚îÇ B·∫•t k·ª≥   ‚îÇ Delivered‚îÇ 400.000‚îÇ ‚úÖ 40.000‚îÇ 400.000 ‚îÇ 360.000  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

================================================================================
V. V√ç D·ª§ TH√äM - NHI·ªÄU ƒê∆†N H√ÄNG TRONG 1 NG√ÄY
================================================================================

NG√ÄY: 2025-10-24

ƒê∆†NVANG 1:
  OrderID: 12345
  TotalAmount: 400.000 ƒë
  Commission (10%): 40.000 ƒë
  ShopNetRevenue: 360.000 ƒë

ƒê∆†NVANG 2:
  OrderID: 12346
  TotalAmount: 250.000 ƒë
  Commission (10%): 25.000 ƒë
  ShopNetRevenue: 225.000 ƒë

ƒê∆†NVANG 3 (SHOP B v·ªõi 15% chi·∫øt kh·∫•u):
  OrderID: 12347
  ShopID: 2
  TotalAmount: 500.000 ƒë
  Commission (15%): 75.000 ƒë
  ShopNetRevenue: 425.000 ƒë

T·ªîNG H·ª¢P NG√ÄY 2025-10-24:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SHOP A (Commission: 10%)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ T·ªïng Doanh Thu:    650.000 ƒë       ‚îÇ
‚îÇ (Order 1: 400.000 + Order 2: 250.000)
‚îÇ T·ªïng Chi·∫øt Kh·∫•u:   65.000 ƒë        ‚îÇ
‚îÇ T·ªïng Net Revenue:  585.000 ƒë       ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ PLATFORM NH·∫¨N:     65.000 ƒë        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SHOP B (Commission: 15%)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ T·ªïng Doanh Thu:    500.000 ƒë       ‚îÇ
‚îÇ T·ªïng Chi·∫øt Kh·∫•u:   75.000 ƒë        ‚îÇ
‚îÇ T·ªïng Net Revenue:  425.000 ƒë       ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ PLATFORM NH·∫¨N:     75.000 ƒë        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ T·ªîNG PLATFORM (H√îM NAY)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ T·ª´ Shop A:         65.000 ƒë        ‚îÇ
‚îÇ T·ª´ Shop B:         75.000 ƒë        ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ        ‚îÇ
‚îÇ T·ªîNG:              140.000 ƒë       ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ T·ªïng Doanh Thu To√†n H·ªá Th·ªëng:    ‚îÇ
‚îÇ = 650.000 (Shop A) + 500.000 (Shop B)
‚îÇ = 1.150.000 ƒë                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

================================================================================
VI. B·∫¢NG DATABASE - D·ªÆ LI·ªÜU L∆ØU TR·ªÆ
================================================================================

TABLE: Shops
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ shop_id ‚îÇ shop_name    ‚îÇ commission_pct ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1       ‚îÇ Fashion A    ‚îÇ 10.00          ‚îÇ
‚îÇ 2       ‚îÇ Fashion B    ‚îÇ 15.00          ‚îÇ
‚îÇ 3       ‚îÇ Tech Store   ‚îÇ 8.50           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

TABLE: ShopAnalytics (updated when order delivered)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ analytics_id ‚îÇ shop_id ‚îÇ period_type ‚îÇ period_start ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1001         ‚îÇ 1       ‚îÇ DAY         ‚îÇ 2025-10-24   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îÇ period_end   ‚îÇ total_revenue ‚îÇ total_orders ‚îÇ commission_pct‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 2025-10-24   ‚îÇ 650.000       ‚îÇ 2            ‚îÇ 10.00         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îÇ commission_amount ‚îÇ shop_net_revenue ‚îÇ growth_percent ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 65.000            ‚îÇ 585.000          ‚îÇ 0.0            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

TABLE: Payments (kh√¥ng thay ƒë·ªïi, v·∫´n ghi 400.000)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ payment_id   ‚îÇ order_id ‚îÇ amount     ‚îÇ payment_status ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 5001         ‚îÇ 12345    ‚îÇ 400.000    ‚îÇ Success        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

================================================================================
VII. CODE IMPLEMENTATION - ƒê·ªÄ XU·∫§T
================================================================================

File: src/main/java/com/example/demo/service/impl/DailyAnalyticsServiceImpl.java

Th√™m v√†o h√†m updateShopAnalytics():

```java
private void updateShopAnalytics(Integer shopId, LocalDate date, Order order) {
    ShopAnalytics analytics = shopAnalyticsRepository.findAll().stream()
        .filter(a -> a.getShop() != null && a.getShop().getId().equals(shopId))
        .filter(a -> "DAY".equals(a.getPeriodType()))
        .filter(a -> date.equals(a.getPeriodStart()))
        .findFirst()
        .orElseGet(() -> {
            ShopAnalytics newAnalytics = new ShopAnalytics();
            newAnalytics.setShop(order.getShop());
            newAnalytics.setPeriodType("DAY");
            newAnalytics.setPeriodStart(date);
            newAnalytics.setPeriodEnd(date);
            newAnalytics.setTotalRevenue(BigDecimal.ZERO);
            newAnalytics.setTotalOrders(0);
            newAnalytics.setTotalViews(0);
            return newAnalytics;
        });
    
    // Add order revenue
    analytics.setTotalRevenue(analytics.getTotalRevenue().add(order.getTotalAmount()));
    analytics.setTotalOrders(analytics.getTotalOrders() + 1);
    
    // üÜï T√çNH CHI·∫æT KH·∫§U
    Shop shop = order.getShop();
    if (shop != null && shop.getCommissionPercentage() != null) {
        BigDecimal commissionPercentage = shop.getCommissionPercentage();
        
        // T√≠nh ti·ªÅn chi·∫øt kh·∫•u
        BigDecimal commissionAmount = order.getTotalAmount()
            .multiply(commissionPercentage)
            .divide(new BigDecimal("100"), 2, RoundingMode.HALF_UP);
        
        // T√≠nh ti·ªÅn shop th·ª±c nh·∫≠n
        BigDecimal shopNetRevenue = order.getTotalAmount()
            .subtract(commissionAmount);
        
        // L∆∞u v√†o ShopAnalytics
        analytics.setCommissionPercentage(commissionPercentage);
        analytics.setCommissionAmount(
            (analytics.getCommissionAmount() != null ? 
             analytics.getCommissionAmount() : BigDecimal.ZERO)
            .add(commissionAmount)
        );
        analytics.setShopNetRevenue(
            (analytics.getShopNetRevenue() != null ? 
             analytics.getShopNetRevenue() : BigDecimal.ZERO)
            .add(shopNetRevenue)
        );
    }
    
    shopAnalyticsRepository.save(analytics);
}
```

================================================================================
VIII. CH√ö √ù QUAN TR·ªåNG
================================================================================

1. ‚è∞ TH·ªúI ƒêI·ªÇM T√çNH CHI·∫æT KH·∫§U:
   - KHI N√ÄO: Order ƒë∆∞·ª£c Delivered (giao th√†nh c√¥ng)
   - KH√îNG PH·∫¢I: Khi order ƒë∆∞·ª£c t·∫°o hay thanh to√°n
   - L√ù DO: Ph·∫£i ch·∫Øc ch·∫Øn kh√°ch ƒë√£ nh·∫≠n h√†ng m·ªõi t√≠nh

2. üí∞ CHI·∫æT KH·∫§U L√Ä PH√çA PLATFORM:
   - Ti·ªÅn n√†y KH√îNG thu·ªôc v·ªÅ shop
   - Shop kh√¥ng th·ªÉ r√∫t ti·ªÅn n√†y
   - N√≥ l√† doanh thu c·ªßa n·ªÅn t·∫£ng

3. üìä ANALYTICS V√Ä REPORT:
   - totalRevenue: Ghi nh·∫≠n c√¥ng khai (doanh thu s∆° b·ªô)
   - shopNetRevenue: Ti·ªÅn th·ª±c t·∫ø shop nh·∫≠n
   - commissionAmount: Ti·ªÅn platform l·∫•y

4. üîÑ T√çNH CUMULATIVE:
   - N·∫øu c√≥ nhi·ªÅu order trong 1 ng√†y
   - C·ªông d·ªìn t·∫•t c·∫£ chi·∫øt kh·∫•u v√†o ShopAnalytics
   - Kh√¥ng t√≠nh ri√™ng t·ª´ng order

5. ‚úÖ VALIDATION:
   - ƒê·∫£m b·∫£o shop c√≥ commission_percentage ƒë∆∞·ª£c c·∫•u h√¨nh
   - N·∫øu kh√¥ng c√≥, m·∫∑c ƒë·ªãnh = 0% (kh√¥ng t√≠nh chi·∫øt kh·∫•u)

================================================================================
IX. T√ìML·∫†I - QUYTR√åNH T·∫†I M·ªòT D√íNG
================================================================================

KH√ÅCH ƒê·∫∂T ‚Üí THANH TO√ÅN ‚Üí GIAO H√ÄNG ‚Üí KH√ÅCH NH·∫¨N ‚úì
                                           ‚Üì
                              T√çNH CHI·∫æT KH·∫§U
                                           ‚Üì
                    L∆ØU V√ÄO SHOPANALYTICS
                                           ‚Üì
                    HI·ªÇN TH·ªä TR√äN DASHBOARD
                                           ‚Üì
                    SHOP R√öT TI·ªÄN (TR·ª™ CHI·∫æT KH·∫§U)

================================================================================
