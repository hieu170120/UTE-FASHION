<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">

<head>
<title th:text="${product.productName}">Product Detail</title>
<th:block layout:fragment="styles">
	<style>
/* --- General & Typography --- */
body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
		"Helvetica Neue", Arial, sans-serif;
}

.breadcrumb {
	background-color: transparent;
	font-size: 14px;
}

.product-details h2 {
	font-size: 20px; /* Cỡ chữ giống mẫu */
	font-weight: normal;
	text-transform: uppercase;
	margin-bottom: 8px;
}

.product-details .product-meta {
	font-size: 14px;
	color: #888;
	margin-bottom: 20px;
}

.option-label {
	font-weight: bold;
	margin-bottom: 10px;
	display: block;
	font-size: 16px;
}

.size-guide-link {
	display: block;
	margin-top: 10px;
	font-size: 14px;
	color: #000;
	text-decoration: none;
}

.size-guide-link:hover {
	text-decoration: underline;
}

/* --- Image Gallery --- */
.thumbnail-list {
	display: flex;
	flex-direction: column;
	gap: 10px;
	max-height: 500px; /* Có thể điều chỉnh */
	overflow-y: auto;
}

.thumbnail-item img {
	width: 100%;
	height: auto;
	cursor: pointer;
	border: 2px solid transparent;
	transition: border-color 0.2s;
}

.thumbnail-item img.active, .thumbnail-item img:hover {
	border-color: #000; /* Border đen khi hover/active */
}

.main-image img {
	width: 100%;
	height: auto; /* Giữ tỷ lệ ảnh */
	object-fit: contain;
}

/* --- Pricing --- */
.product-price .sale-price {
	font-size: 28px;
	font-weight: bold;
	color: #e60023; /* Màu đỏ tươi */
}

.product-price .original-price {
	font-size: 20px;
	color: #888;
	margin-left: 10px;
}

.product-price .discount-badge {
	background-color: #e60023;
	color: white;
	font-size: 14px;
	font-weight: bold;
	padding: 4px 8px;
	border-radius: 4px;
	margin-left: 10px;
	vertical-align: middle;
}

/* --- Size Options --- */
.size-options {
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
}

.size-option {
	border: 1px solid #ccc;
	padding: 8px 16px;
	cursor: pointer;
	background-color: #fff;
	transition: border-color 0.2s;
	position: relative; /* Cần cho dấu tick */
}

.size-option:hover {
	border-color: #000;
}

.size-option.active {
	border-color: #000;
}
/* Dấu tick khi size được chọn */
.size-option.active::after {
	content: '';
	display: block;
	width: 15px;
	height: 15px;
	background-image:
		url('https://img.icons8.com/ios-filled/50/000000/checkmark--v1.png');
	background-size: contain;
	background-repeat: no-repeat;
	position: absolute;
	top: -1px;
	right: -1px;
}

/* --- Color Options --- */
.color-options {
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
}

.color-option {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    border: 1px solid #ccc;
    padding: 2px;
    transition: border-color 0.2s;
    /* --- Thêm các dòng dưới đây --- */
    display: flex;
    justify-content: center;
    align-items: center;
}
.color-option:hover {
	border-color: #000;
}

.color-option.active {
	border-color: #000;
	border-width: 2px; /* Border dày hơn khi được chọn */
}

.color-swatch {
	width: 100%;
	height: 100%;
	border-radius: 50%;
	display: block;
}

/* --- Quantity Selector --- */
.quantity-selector {
	display: flex;
	border: 1px solid #ccc;
	width: 150px;
	height: 40px;
	align-items: center;
}

.quantity-selector button {
	background-color: transparent;
	border: none;
	font-size: 20px;
	cursor: pointer;
	padding: 0 15px;
	color: #555;
	height: 100%;
}

.quantity-selector input {
	width: 100%;
	border: none;
	text-align: center;
	font-size: 16px;
	font-weight: bold;
	-moz-appearance: textfield; /* Firefox */
}

.quantity-selector input::-webkit-outer-spin-button, .quantity-selector input::-webkit-inner-spin-button
	{
	-webkit-appearance: none; /* Chrome, Safari, Edge, Opera */
	margin: 0;
}

/* --- Action Buttons --- */
.action-buttons .btn {
	width: 100%;
	padding: 12px;
	font-size: 16px;
	font-weight: bold;
	text-transform: uppercase;
	border-radius: 0; /* Bỏ bo góc */
	border-width: 2px;
	transition: background-color 0.2s, color 0.2s;
}

.btn-add-to-cart {
	background-color: #fff;
	color: #000;
	border: 2px solid #000;
}

.btn-add-to-cart:hover {
	background-color: #f0f0f0;
	color: #000;
}

.btn-buy-now {
	background-color: #000;
	color: #fff;
	border: 2px solid #000;
}

.btn-buy-now:hover {
	background-color: #333;
	border-color: #333;
	color: #fff;
}

/* --- Product Description --- */
.product-description {
	margin-top: 30px;
}

.product-description p {
	margin-bottom: 5px;
	font-size: 14px;
	line-height: 1.6;
}

.product-description strong {
	font-weight: bold;
}
</style>
</th:block>
</head>

<body>

	<div class="container" layout:fragment="content">
		<!-- Breadcrumb -->
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a th:href="@{/}">TRANG CHỦ</a></li>
				<li class="breadcrumb-item"><a th:href="@{/products}">TẤT
						CẢ SẢN PHẨM</a></li>
				<li class="breadcrumb-item active" aria-current="page"
					th:text="${product.productName.toUpperCase()}"></li>
			</ol>
		</nav>

		<div class="row">
			<!-- Product Image Gallery -->
			<div class="col-md-7">
				<div class="row">
					<div class="col-md-2 order-md-1">
						<div class="thumbnail-list">
							<div class="thumbnail-item"
								th:each="image, iterStat : ${product.images}">
								<img th:src="${image.imageUrl}" th:alt="${product.productName}"
									th:classappend="${iterStat.index == 0} ? 'active'"
									onclick="changeMainImage(this.src)">
							</div>
						</div>
					</div>
					<div class="col-md-10 order-md-2">
						<div class="main-image">
							<img id="mainProductImage"
								th:if="${!#lists.isEmpty(product.images)}"
								th:src="${product.images[0].imageUrl}"
								th:alt="${product.productName}"> <img
								id="mainProductImagePlaceholder"
								th:if="${#lists.isEmpty(product.images)}"
								src="https://via.placeholder.com/500" alt="No Image Available">
						</div>
					</div>
				</div>
			</div>

			<div class="col-md-5 product-details">
				<h2 th:text="${product.productName}"></h2>
				<p class="product-meta">
					Thương hiệu: <span
						th:text="${brand != null ? brand.brandName : 'N/A'}"></span> | Mã
					SP: <span th:text="${product.sku}"></span>
				</p>

				<div class="my-3 product-price d-flex align-items-center">
					<span class="sale-price"
						th:text="${#numbers.formatDecimal(product.salePrice, 0, 'COMMA', 0, 'POINT')} + 'đ'"></span>
					<span class="original-price text-decoration-line-through"
						th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + 'đ'"></span>
					<span class="discount-badge" th:if="${product.price > 0}"
						th:text="'-' + ${#numbers.formatInteger(((product.price - product.salePrice) * 100) / product.price, 0)} + '%'"></span>
				</div>

				<div class="mb-4">
					<label class="option-label">Kích thước</label>
					<div class="size-options">
						<div th:each="variant : ${variants}"
							th:if="${variant.size != null}">
							<span class="size-option" th:text="${variant.size.sizeName}"
								th:attr="data-size=${variant.size.sizeName}"
								onclick="selectSize(this)"></span>
						</div>
					</div>
					<a href="#" class="size-guide-link">HƯỚNG DẪN CHỌN SIZE</a>
				</div>

				<div class="mb-4">
					<label class="option-label">Màu sắc</label>
					<div class="color-options">
						<th:block th:each="variant : ${variants}"
							th:if="${variant.color != null}">
							<span class="color-option"
								th:attr="data-color=${variant.color.colorName}"
								onclick="selectColor(this)"> <span class="color-swatch"
								th:style="'background-color:' + ${variant.color.colorCode}"></span>
							</span>
						</th:block>
					</div>
				</div>

				<div class="mb-4">
					<label class="option-label">Số lượng</label>
					<div class="quantity-selector">
						<button type="button" onclick="this.nextElementSibling.stepDown()">&#60;</button>
						<input type="number" class="form-control text-center" value="1"
							min="1">
						<button type="button"
							onclick="this.previousElementSibling.stepUp()">&#62;</button>
					</div>
				</div>

				<div class="d-grid gap-2 mt-4 action-buttons">
					<button class="btn btn-add-to-cart" type="button">THÊM VÀO
						GIỎ</button>
					<button class="btn btn-buy-now" type="button">MUA NGAY</button>
				</div>

				<div class="mt-4 product-description">
					<p>
						<strong>Chất liệu:</strong> <span th:text="${product.material}">vải
							thô</span>
					</p>
					<div th:utext="${product.description}">
						<p>
							<strong>Kiểu dáng:</strong> áo sơ mi thiết kế tay lỡ bồng nhẹ, áo
							dáng suông với chiều dài vừa phải, phù hợp thả suông tạo sự trẻ
							trung và thoải mái. sản phẩm sử dụng tone màu xanh nhạt, pha cổ
							trắng tạo điểm nhấn
						</p>
						<p>
							<strong>Sản phẩm thuộc dòng sản phẩm:</strong> NEW NEM
						</p>
						<p>
							<strong>Sản phẩm kết hợp:</strong> chân váy Z05452
						</p>
						<p>
							<strong>Thông tin người mẫu:</strong> mặc sản phẩm size 2
						</p>
					</div>
				</div>
			</div>

			<!-- Product Reviews -->
			<div class="row mt-5">
				<div class="col-12">
					<hr>
					<h3 class="mb-4">Đánh giá sản phẩm</h3>
					<!-- Review content goes here -->
				</div>
			</div>

			<!-- Similar Products -->
			<div class="row mt-5">
				<div class="col-12">
					<h3 class="text-center mb-4">SẢN PHẨM TƯƠNG TỰ</h3>
					<!-- Similar products carousel goes here -->
				</div>
			</div>
		</div>
    </div>
		<th:block layout:fragment="scripts">
			<script>
        function changeMainImage(src) {
            document.getElementById('mainProductImage').src = src;
            // Also update active state on thumbnails
            document.querySelectorAll('.thumbnail-item img').forEach(img => img.classList.remove('active'));
            event.target.classList.add('active');
        }

        function selectSize(element) {
            document.querySelectorAll('.size-option').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }
        
        function selectColor(element) {
            document.querySelectorAll('.color-option').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }
    </script>
		</th:block>
</body>
</html>
